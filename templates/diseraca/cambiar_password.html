{% extends 'diseraca/base_index.html' %}

{% block nav %}
    <nav>
    <div class="nav-wrapper container">
      <a href="/" class="brand-logo">Diseraca</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>

    </div>
  </nav>

{% endblock %}

{% block contenido %}
    <div class="row" ng-controller="LoginController">
        <div class="col s8 l4 offset-s1 offset-l4">
            <form class="col s12 l12 card-panel" action="view_init_password" method="post">
                <div id="token">
                    {% csrf_token %}
                </div>
                <div class="row">
                    <div class="input-field col s10 l10 offset-s1 offset-l1">
                        <i class="material-icons prefix">lock_outline</i>
                        <input id="icon_telephone" type="password" class="validate" name="password1" required>
                        <label for="icon_telephone">Nueva Contraseña</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s10 l10 offset-s1 offset-l1">
                        <i class="material-icons prefix">lock_outline</i>
                        <input id="icon_telephone" type="password" class="validate" name="password2" required>
                        <label for="icon_telephone">Repetir Nueva Contraseña</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s10 l10 offset-s1 offset-l1">
                        <i class="material-icons prefix">contact_mail</i>
                        <input id="icon_telephone" type="email" class="validate"
                               name="email" required placeholder="Correo" value="{{ correo }}">
                        <label for="icon_telephone">Correo</label>
                    </div>
                </div>

                <div class="row center">
                    <div class="input-field col s6 l6 offset-s3 offset-l3">
                        <button class="btn waves-effect waves-light" type="submit" name="action" onclick="cargar_preload()">Aceptar
                            <i class="material-icons right">send</i>
                        </button>
                    </div>
                    <div id="carga" class="preloader-wrapper medium">
                        <!-- colocar active o quitarlo cuando se ejecute es bonton de buscar -->
                        <div class="spinner-layer spinner-blue">
                            <div class="circle-clipper left">
                                <div class="circle"></div>
                            </div>
                            <div class="gap-patch">
                                <div class="circle"></div>
                            </div>
                            <div class="circle-clipper right">
                                <div class="circle"></div>
                            </div>
                        </div>

                        <div class="spinner-layer spinner-red">
                            <div class="circle-clipper left">
                                <div class="circle"></div>
                            </div><div class="gap-patch">
                            <div class="circle"></div>
                            </div><div class="circle-clipper right">
                            <div class="circle"></div>
                            </div>
                        </div>

                        <div class="spinner-layer spinner-yellow">
                            <div class="circle-clipper left">
                            <div class="circle"></div>
                            </div><div class="gap-patch">
                            <div class="circle"></div>
                            </div><div class="circle-clipper right">
                            <div class="circle"></div>
                            </div>
                        </div>

                        <div class="spinner-layer spinner-green">
                            <div class="circle-clipper left">
                            <div class="circle"></div>
                            </div><div class="gap-patch">
                            <div class="circle"></div>
                            </div><div class="circle-clipper right">
                            <div class="circle"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            {% if msg %}
                <div class="row">
                    <h5 class="red-text">{{ msg }}</h5>
                </div>
            {% endif %}


        </div>

        <div class="col s2 l2">
            <h5>patron requerido:</h5>
            <p class="red-text">
                por lo menos una letra Mayuscula
            </p>
            <p class="red-text">
                Por lo menos 2 número
            </p>
            <p class="red-text">
                El tamaño de la contraseña debe superar los 8 caracteres.
            </p>
        </div>
    </div>

{% endblock %}

{% block init %}
    {% if msg %}
        if ("Notification" in window){
            let ask = Notification.requestPermission();
            ask.then(permission => {
                if (permission ==='granted') {
                    let msg = new Notification('Mensaje', {
                        body: "{{ msg }}",
                        icon:"/static/img/ufps.jpg"
                    });
                }
            });
        }

    {% endif %}


{% endblock %}

{% block script %}
    function cargar_preload(){
        $('#carga').addClass('active');
    }
{% endblock %}